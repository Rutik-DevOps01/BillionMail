"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([["1517"],{27062:function(e,a,t){t.d(a,{Z:()=>n});var l=t(58786),i=t(82518),s=t(86223);function n(e={},a){let t=(0,l.qj)({ctrl:!1,command:!1,win:!1,shift:!1,tab:!1}),{keydown:r,keyup:o}=e,u=e=>{switch(e.key){case"Control":t.ctrl=!0;break;case"Meta":t.command=!0,t.win=!0;break;case"Shift":t.shift=!0;break;case"Tab":t.tab=!0}void 0!==r&&Object.keys(r).forEach(a=>{if(a!==e.key)return;let t=r[a];if("function"==typeof t)t(e);else{let{stop:a=!1,prevent:l=!1}=t;a&&e.stopPropagation(),l&&e.preventDefault(),t.handler(e)}})},d=e=>{switch(e.key){case"Control":t.ctrl=!1;break;case"Meta":t.command=!1,t.win=!1;break;case"Shift":t.shift=!1;break;case"Tab":t.tab=!1}void 0!==o&&Object.keys(o).forEach(a=>{if(a!==e.key)return;let t=o[a];if("function"==typeof t)t(e);else{let{stop:a=!1,prevent:l=!1}=t;a&&e.stopPropagation(),l&&e.preventDefault(),t.handler(e)}})},c=()=>{(void 0===a||a.value)&&((0,i.on)("keydown",document,u),(0,i.on)("keyup",document,d)),void 0!==a&&(0,l.YP)(a,e=>{e?((0,i.on)("keydown",document,u),(0,i.on)("keyup",document,d)):((0,i.S)("keydown",document,u),(0,i.S)("keyup",document,d))})};return(0,s.N)()?((0,l.wF)(c),(0,l.Jd)(()=>{(void 0===a||a.value)&&((0,i.S)("keydown",document,u),(0,i.S)("keyup",document,d))})):c(),(0,l.OT)(t)}},46471:function(e,a,t){t.d(a,{Z:()=>p});var l=t(32510),i=t(91792),s=t(75266),n=t(3073),r=t(67737),o=t(4339),u=t(98168),d=t(77407),c=Object.prototype.hasOwnProperty;let p=function(e){if(null==e)return!0;if((0,r.Z)(e)&&((0,n.Z)(e)||"string"==typeof e||"function"==typeof e.splice||(0,o.Z)(e)||(0,d.Z)(e)||(0,s.Z)(e)))return!e.length;var a=(0,i.Z)(e);if("[object Map]"==a||"[object Set]"==a)return!e.size;if((0,u.Z)(e))return!(0,l.Z)(e).length;for(var t in e)if(c.call(e,t))return!1;return!0}},66236:function(e,a,t){t.d(a,{W3:()=>c,ZP:()=>m});var l=t(58786),i=t(56946),s=t(54470),n=t(53198),r=t(19050),o=t(55456),u=t(71309);let d=(0,u.cB)("breadcrumb",`
 white-space: nowrap;
 cursor: default;
 line-height: var(--n-item-line-height);
`,[(0,u.c)("ul",`
 list-style: none;
 padding: 0;
 margin: 0;
 `),(0,u.c)("a",`
 color: inherit;
 text-decoration: inherit;
 `),(0,u.cB)("breadcrumb-item",`
 font-size: var(--n-font-size);
 transition: color .3s var(--n-bezier);
 display: inline-flex;
 align-items: center;
 `,[(0,u.cB)("icon",`
 font-size: 18px;
 vertical-align: -.2em;
 transition: color .3s var(--n-bezier);
 color: var(--n-item-text-color);
 `),(0,u.c)("&:not(:last-child)",[(0,u.cM)("clickable",[(0,u.cE)("link",`
 cursor: pointer;
 `,[(0,u.c)("&:hover",`
 background-color: var(--n-item-color-hover);
 `),(0,u.c)("&:active",`
 background-color: var(--n-item-color-pressed); 
 `)])])]),(0,u.cE)("link",`
 padding: 4px;
 border-radius: var(--n-item-border-radius);
 transition:
 background-color .3s var(--n-bezier),
 color .3s var(--n-bezier);
 color: var(--n-item-text-color);
 position: relative;
 `,[(0,u.c)("&:hover",`
 color: var(--n-item-text-color-hover);
 `,[(0,u.cB)("icon",`
 color: var(--n-item-text-color-hover);
 `)]),(0,u.c)("&:active",`
 color: var(--n-item-text-color-pressed);
 `,[(0,u.cB)("icon",`
 color: var(--n-item-text-color-pressed);
 `)])]),(0,u.cE)("separator",`
 margin: 0 8px;
 color: var(--n-separator-color);
 transition: color .3s var(--n-bezier);
 user-select: none;
 -webkit-user-select: none;
 `),(0,u.c)("&:last-child",[(0,u.cE)("link",`
 font-weight: var(--n-font-weight-active);
 cursor: unset;
 color: var(--n-item-text-color-active);
 `,[(0,u.cB)("icon",`
 color: var(--n-item-text-color-active);
 `)]),(0,u.cE)("separator",`
 display: none;
 `)])])]),c=(0,r.U)("n-breadcrumb"),p=Object.assign(Object.assign({},i.Z.props),{separator:{type:String,default:"/"}}),m=(0,l.aZ)({name:"Breadcrumb",props:p,setup(e){let{mergedClsPrefixRef:a,inlineThemeDisabled:t}=(0,s.ZP)(e),r=(0,i.Z)("Breadcrumb","-breadcrumb",d,o.Z,e,a);(0,l.JJ)(c,{separatorRef:(0,l.Vh)(e,"separator"),mergedClsPrefixRef:a});let u=(0,l.Fl)(()=>{let{common:{cubicBezierEaseInOut:e},self:{separatorColor:a,itemTextColor:t,itemTextColorHover:l,itemTextColorPressed:i,itemTextColorActive:s,fontSize:n,fontWeightActive:o,itemBorderRadius:u,itemColorHover:d,itemColorPressed:c,itemLineHeight:p}}=r.value;return{"--n-font-size":n,"--n-bezier":e,"--n-item-text-color":t,"--n-item-text-color-hover":l,"--n-item-text-color-pressed":i,"--n-item-text-color-active":s,"--n-separator-color":a,"--n-item-color-hover":d,"--n-item-color-pressed":c,"--n-item-border-radius":u,"--n-font-weight-active":o,"--n-item-line-height":p}}),p=t?(0,n.F)("breadcrumb",void 0,u,e):void 0;return{mergedClsPrefix:a,cssVars:t?void 0:u,themeClass:null==p?void 0:p.themeClass,onRender:null==p?void 0:p.onRender}},render(){var e;return null==(e=this.onRender)||e.call(this),(0,l.h)("nav",{class:[`${this.mergedClsPrefix}-breadcrumb`,this.themeClass],style:this.cssVars,"aria-label":"Breadcrumb"},(0,l.h)("ul",null,this.$slots))}})},70958:function(e,a,t){t.d(a,{Z:()=>r});var l=t(58786),i=t(93950),s=t(68574),n=t(66236);let r=(0,l.aZ)({name:"BreadcrumbItem",props:{separator:String,href:String,clickable:{type:Boolean,default:!0},onClick:Function},slots:Object,setup(e,{slots:a}){let t=(0,l.f3)(n.W3,null);if(!t)return()=>null;let{separatorRef:r,mergedClsPrefixRef:o}=t,u=function(e=s.j?window:null){let a=()=>{let{hash:a,host:t,hostname:l,href:i,origin:s,pathname:n,port:r,protocol:o,search:u}=(null==e?void 0:e.location)||{};return{hash:a,host:t,hostname:l,href:i,origin:s,pathname:n,port:r,protocol:o,search:u}},t=(0,l.iH)(a()),i=()=>{t.value=a()};return(0,l.bv)(()=>{e&&(e.addEventListener("popstate",i),e.addEventListener("hashchange",i))}),(0,l.SK)(()=>{e&&(e.removeEventListener("popstate",i),e.removeEventListener("hashchange",i))}),t}(),d=(0,l.Fl)(()=>e.href?"a":"span"),c=(0,l.Fl)(()=>u.value.href===e.href?"location":null);return()=>{let{value:t}=o;return(0,l.h)("li",{class:[`${t}-breadcrumb-item`,e.clickable&&`${t}-breadcrumb-item--clickable`]},(0,l.h)(d.value,{class:`${t}-breadcrumb-item__link`,"aria-current":c.value,href:e.href,onClick:e.onClick},a),(0,l.h)("span",{class:`${t}-breadcrumb-item__separator`,"aria-hidden":"true"},(0,i.gI)(a.separator,()=>{var a;return[null!=(a=e.separator)?a:r.value]})))}}})},50144:function(e,a,t){t.d(a,{Z:()=>u});var l=t(58786),i=t(56946),s=t(54470),n=t(49942),r=t(44108);let o=Object.assign(Object.assign({},n.Kd),i.Z.props),u=(0,l.aZ)({name:"Tooltip",props:o,slots:Object,__popover__:!0,setup(e){let{mergedClsPrefixRef:a}=(0,s.ZP)(e),t=(0,i.Z)("Tooltip","-tooltip",void 0,r.Z,e,a),n=(0,l.iH)(null);return Object.assign(Object.assign({},{syncPosition(){n.value.syncPosition()},setShow(e){n.value.setShow(e)}}),{popoverRef:n,mergedTheme:t,popoverThemeOverrides:(0,l.Fl)(()=>t.value.self)})},render(){let{mergedTheme:e,internalExtraClass:a}=this;return(0,l.h)(n.ZP,Object.assign(Object.assign({},this.$props),{theme:e.peers.Popover,themeOverrides:e.peerOverrides.Popover,builtinThemeOverrides:this.popoverThemeOverrides,internalExtraClass:a.concat("tooltip"),ref:"popoverRef"}),this.$slots)}})},84075:function(e,a,t){t.d(a,{WH:()=>n,Z2:()=>c,gV:()=>v,hI:()=>s,iE:()=>d,mD:()=>u,sS:()=>o,uz:()=>m,yG:()=>p,yL:()=>r});var l=t(34541);let{t:i}=t(76882).ag.global,s=e=>l.e.get("/contact/group/list",{params:e}),n=()=>l.e.get("/contact/group/all"),r=e=>l.e.get("/contact/group/info",{params:e}),o=e=>l.e.post("/contact/group/create",e,{fetchOptions:{loading:i("contacts.group.loading.createGroup"),successMessage:!0}}),u=e=>l.e.post("/contact/group/update",e,{fetchOptions:{loading:i("contacts.group.loading.updateGroup"),successMessage:!0}}),d=e=>l.e.post("/contact/group/delete",e,{fetchOptions:{loading:i("contacts.group.loading.deleteGroup"),successMessage:!0}}),c=e=>l.e.post("/contact/group/tag_contact_count",e),p=e=>l.e.post("/contact/group/export",e,{responseType:"blob",fetchOptions:{loading:i("contacts.group.loading.exportGroup"),successMessage:!0}}),m=e=>l.e.post("/contact/group/update",e,{fetchOptions:{loading:i("contacts.group.loading.saveSettings"),successMessage:!0}}),v=e=>l.e.post("/contact/group/update_unsubscribe",e,{fetchOptions:{loading:i("contacts.group.loading.saveSettings"),successMessage:!0}})},39432:function(e,a,t){t.d(a,{Aj:()=>h,Au:()=>p,Fj:()=>o,LC:()=>n,Lb:()=>b,M7:()=>_,OV:()=>c,dj:()=>d,gK:()=>u,i7:()=>s,nf:()=>k,qt:()=>r,rU:()=>f,v1:()=>m,xh:()=>g,yW:()=>v});var l=t(34541);let{t:i}=t(76882).ZP.global,s=e=>l.e.get("/domains/list",{params:e}),n=()=>l.e.get("/domains/all"),r=()=>l.e.post("/multi_ip_domain/apply"),o=e=>l.e.post("/domains/create",e,{fetchOptions:{loading:i("domain.api.loading.creating"),successMessage:!0}}),u=e=>l.e.post("/domains/update",e,{fetchOptions:{loading:i("domain.api.loading.updating"),successMessage:!0}}),d=e=>l.e.post("/domains/delete",e,{fetchOptions:{loading:i("domain.api.loading.deleting"),successMessage:!0}}),c=e=>l.e.post("/domains/set_ssl",e,{fetchOptions:{loading:i("domain.api.loading.settingSSL"),successMessage:!0}}),p=e=>l.e.get("/domains/get_ssl",{params:e}),m=e=>l.e.post("/domains/fresh_dns_records",e,{fetchOptions:{loading:i("domain.api.loading.refreshingDns"),successMessage:!0}}),v=e=>l.e.post("/ssl/apply_cert",e,{fetchOptions:{loading:i("domain.api.loading.applyingCert"),successMessage:!0}}),g=e=>l.e.post("/domains/set_default_domain",e,{fetchOptions:{loading:i("domain.api.loading.settingDefault"),successMessage:!0}}),f=e=>l.e.post("/askai/project/create",e,{fetchOptions:{loading:i("domain.api.loading.settingBrandInfo"),successMessage:!0}}),_=e=>l.e.post("/multi_ip_domain/test",e,{fetchOptions:{loading:i("domain.api.loading.testingConnection"),successMessage:!0}}),b=()=>l.e.post("/askai/supplier/status"),k=e=>l.e.post("/domain_blocklist/check",e,{fetchOptions:{loading:i("domain.api.loading.detecting"),successMessage:!0}}),h=e=>l.e.get("/domain_blocklist/logs",{params:e})},67127:function(e,a,t){t.d(a,{EV:()=>o,H2:()=>c,Ts:()=>n,WS:()=>u,Yi:()=>r,iC:()=>s,ym:()=>d});var l=t(34541);let{t:i}=t(76882).ZP.global,s=e=>l.e.get("/mailbox/list",{params:e}),n=e=>l.e.post("/mailbox/create",e,{fetchOptions:{loading:i("mailbox.api.loading.creating"),successMessage:!0}}),r=e=>l.e.post("/mailbox/batch_create",e,{fetchOptions:{loading:i("mailbox.api.loading.creating"),successMessage:!0}}),o=e=>l.e.post("/mailbox/update",e,{fetchOptions:{loading:i("mailbox.api.loading.updating"),successMessage:!0}}),u=e=>l.e.post("/mailbox/delete",e,{fetchOptions:{loading:i("mailbox.api.loading.deleting"),successMessage:!0}}),d=e=>l.e.post("/mailbox/export",e,{responseType:"blob",fetchOptions:{loading:i("mailbox.api.loading.exporting"),successMessage:!0}}),c=e=>l.e.post("/mailbox/import",e,{fetchOptions:{loading:i("mailbox.api.loading.importing"),successMessage:!0}})},55855:function(e,a,t){t.d(a,{Gk:()=>r,Q5:()=>m,Xr:()=>p,ZS:()=>n,_5:()=>c,gI:()=>u,jC:()=>v,ke:()=>g,mQ:()=>o,oS:()=>f,xJ:()=>d});var l=t(76882),i=t(34541);let{t:s}=l.ag.global;function n(e){return i.e.get("/batch_mail/task/list",{params:e})}function r(e){return i.e.get("/batch_mail/task/stat_chart",{params:e})}function o(e){return i.e.get("/batch_mail/task/find",{params:e})}function u(e){return i.e.post("/batch_mail/task/create",e,{fetchOptions:{loading:s("market.task.loading.creating"),successMessage:!0}})}function d(e){return i.e.post("/batch_mail/task/update",e,{fetchOptions:{loading:s("market.task.loading.updating"),successMessage:!0}})}function c(e){return i.e.post("/batch_mail/task/delete",e,{fetchOptions:{loading:s("market.task.loading.deleting"),successMessage:!0}})}function p(e){return i.e.post("/batch_mail/task/pause",e,{fetchOptions:{loading:s("market.task.loading.pausing"),successMessage:!0}})}function m(e){return i.e.post("/batch_mail/task/resume",e,{fetchOptions:{loading:s("market.task.loading.resuming"),successMessage:!0}})}function v(e){return i.e.post("/batch_mail/task/send_test",e,{fetchOptions:{loading:s("market.task.loading.sendingTest"),successMessage:!0}})}function g(e){return i.e.get("/batch_mail/tracking/mail_provider",{params:e})}function f(e){return i.e.get("/batch_mail/tracking/logs",{params:e})}},31651:function(e,a,t){t.d(a,{A8:()=>n,NI:()=>r,QB:()=>d,WF:()=>u,Xc:()=>p,ef:()=>c,ij:()=>o});var l=t(76882),i=t(34541);let{t:s}=l.ZP.global;function n(e){return i.e.get("/email_template/list",{params:e})}function r(){return i.e.get("/email_template/all")}function o(e){return i.e.get("/email_template/get",{params:e})}function u(e){return i.e.post("/email_template/create",e,{fetchOptions:{loading:s("market.template.loading.creating"),successMessage:!0}})}function d(e){return i.e.post("/email_template/update",e,{fetchOptions:{loading:s("market.template.loading.updating"),successMessage:!0}})}function c(e){return i.e.post("/email_template/copy",e,{fetchOptions:{loading:s("market.template.loading.copying"),successMessage:!0}})}function p(e){return i.e.post("/email_template/delete",e,{fetchOptions:{loading:s("market.template.loading.deleting"),successMessage:!0}})}},43458:function(e,a,t){t.d(a,{CZ:()=>n,Lp:()=>u,Pn:()=>o,Rc:()=>d,kV:()=>s,ln:()=>r});var l=t(34541);let{t:i}=t(76882).ag.global,s=e=>l.e.get("/tags/list",{params:e}),n=e=>l.e.get("/tags/all",{params:e}),r=e=>l.e.post("/tags/create",e,{fetchOptions:{loading:i("contacts.tags.loading.creating"),successMessage:!0}}),o=e=>l.e.post("/tags/delete",e,{fetchOptions:{loading:i("contacts.tags.loading.deleting"),successMessage:!0}}),u=e=>l.e.post("/tags/update",e,{fetchOptions:{loading:i("contacts.tags.loading.updating"),successMessage:!0}}),d=e=>l.e.post("/tags/batch_contacts",e,{fetchOptions:{loading:i("contacts.tags.loading.bulkSetting"),successMessage:!0}})},53472:function(e,a,t){t.d(a,{Z:()=>s});var l=t(58786);let i=["height","srcdoc"],s=(0,l.aZ)({__name:"index",props:{value:{type:String,default:""},height:{type:[String,Number],default:"100%"}},setup:e=>(a,t)=>((0,l.wg)(),(0,l.iD)("iframe",{width:"100%",height:e.height,srcdoc:e.value,style:{border:"none",borderRadius:"4px"}},null,8,i))})},19664:function(e,a,t){t.d(a,{Z:()=>d});var l=t(8490),i=t(58786),s=t(68271),n=t(39432),r=t(67127);let o={class:"flex-1"},u={class:"flex-1 ml-10px"},d=(0,i.aZ)({__name:"FromSelect",props:{value:{},valueModifiers:{},name:{},nameModifiers:{},domain:{},domainModifiers:{}},emits:["update:value","update:name","update:domain"],setup(e){let a=(0,i.tT)(e,"value"),t=(0,i.tT)(e,"name"),d=(0,i.iH)(!1),c=(0,i.tT)(e,"domain"),p=(0,i.iH)([]),m=(0,i.iH)([]),v=(0,i.Fl)(()=>m.value.filter(e=>e.domain===c.value).map(e=>({label:e.username,value:e.username,data:e}))),g=async()=>{await (0,i.Y3)(),v.value.length>0?(a.value=v.value[0].value,f(a.value,v.value[0])):(a.value=null,t.value="")},f=(e,a)=>{let{data:l}=a;(0,s.Kn)(l)&&(t.value=l.full_name)},_=async()=>{let e=await (0,n.LC)();if((0,s.kJ)(e)&&(p.value=e.map(e=>({label:e.domain,value:e.domain})),!c.value&&e.length>0)){let a=e.filter(e=>e.default);a.length>0?c.value=a[0].domain:c.value=e[0].domain}},b=async()=>{let e=await (0,r.iC)({page:1,page_size:1e3,domain:""});(0,s.Kn)(e)&&(m.value=e.list)};return(async()=>{try{d.value=!0,await b(),await _(),await (0,i.Y3)(),null===a.value?g():a.value&&(c.value=a.value.split("@")[1])}finally{d.value=!1}})(),(e,t)=>{let s=l.Z;return(0,i.wg)(),(0,i.iD)(i.HY,null,[(0,i._)("div",o,[(0,i.Wm)(s,{value:c.value,"onUpdate:value":[t[0]||(t[0]=e=>c.value=e),g],loading:(0,i.SU)(d),options:(0,i.SU)(p)},null,8,["value","loading","options"])]),(0,i._)("div",u,[(0,i.Wm)(s,{value:a.value,"onUpdate:value":[t[1]||(t[1]=e=>a.value=e),f],loading:(0,i.SU)(d),options:(0,i.SU)(v),filterable:!0},null,8,["value","loading","options"])])],64)}}})},28444:function(e,a,t){t.d(a,{Z:()=>r});var l=t(8490),i=t(58786),s=t(68271),n=t(31651);let r=(0,i.aZ)({__name:"TemplateSelect",props:{value:{},valueModifiers:{},content:{},contentModifiers:{}},emits:(0,i.Vf)(["listReady"],["update:value","update:content"]),setup(e,a){let{emit:t}=a,r=(0,i.tT)(e,"value"),o=(0,i.tT)(e,"content"),u=(0,i.iH)(!1),d=(0,i.iH)([]),c=(e,a)=>{let{data:t}=a;(0,s.Kn)(t)&&(o.value=t.html_content)};return(async()=>{try{u.value=!0;let e=await (0,n.NI)();if((0,s.kJ)(e)){if(d.value=e.map(e=>({label:e.temp_name,value:e.id,data:e})),null===r.value)r.value=e[0].id,o.value=e[0].html_content;else{let a=e.find(e=>e.id===r.value);a&&(o.value=a.html_content)}t("listReady",e)}}finally{u.value=!1}})(),(e,a)=>{let t=l.Z;return(0,i.wg)(),(0,i.j4)(t,{value:r.value,"onUpdate:value":[a[0]||(a[0]=e=>r.value=e),c],loading:(0,i.SU)(u),filterable:!0,options:(0,i.SU)(d)},null,8,["value","loading","options"])}}})},77145:function(e,a,t){t.r(a),t.d(a,{default:()=>eg});var l=t(53472),i=t(46244),s=t(17977),n=t(57869),r=t(29283),o=t(16715),u=t(2352),d=t(29875),c=t(15496),p=t(81833),m=t(37864),v=t(8490),g=t(73084),f=t(6455),_=t(66236),b=t(70958),k=t(58786),h=t(31708),w=t(94821),U=t(68271),S=t(84075),y=t(55855),x=t(19664),W=t(51169),Z=t(3179),O=t(46471),j=t(98003),M=t(52495);let C={class:"pt-12px"},$={class:"flex-1"},z={class:"mt-8px text-12px text-desc"},T=`email,attributes
example1@example.com,"{""age"": ""13"", ""Gender"": ""XXX""}"
example2@example.com,"{""age"": ""45"", ""city"": ""XXX""}"
`,P=(0,k.aZ)({__name:"CreateGroup",setup(e){let{t:a}=(0,M.QT)(),t=(0,k.AE)("formRef"),l=(0,k.qj)({create_type:2,name:"",file_data:"",file_type:"",description:"",status:1,double_optin:0}),s={name:{required:!0,message:a("market.task.createGroup.validation.groupNameRequired"),trigger:["blur","input"]}},n=[{label:"Confirmed",value:1},{label:"Unconfirmed",value:0}],r=e=>{let a=new FileReader;a.onload=a=>{var t;l.file_type=e.name.substring(e.name.lastIndexOf(".")+1),l.file_data=null==(t=a.target)?void 0:t.result},e.file&&a.readAsText(e.file)},o=async()=>{await (0,j.Sv)({file_path:"./template/example_recipients.csv"})},u=async()=>{var e;if(await (null==(e=t.value)?void 0:e.validate()),(0,O.Z)(l.file_data))return U.v0.error(a("contacts.subscribers.import.validation.fileRequired")),Promise.reject()},[d,p]=(0,W.d)({onChangeState:e=>{e&&(l.name="",l.file_data="",l.file_type="")},onConfirm:async()=>{await u(),await (0,S.sS)((0,k.IU)(l));let e=p.getState();null==e||e.refresh()}});return(e,u)=>{let p=g.Z,m=f.ZP,_=v.Z,b=Z.Z,h=c.ZP,w=i.Z;return(0,k.wg)(),(0,k.j4)((0,k.SU)(d),{title:(0,k.SU)(a)("market.task.createGroup.title"),width:"500"},{default:(0,k.w5)(()=>[(0,k._)("div",C,[(0,k.Wm)(w,{ref_key:"formRef",ref:t,model:(0,k.SU)(l),rules:s},{default:(0,k.w5)(()=>[(0,k.Wm)(m,{label:(0,k.SU)(a)("market.task.createGroup.groupName"),path:"name"},{default:(0,k.w5)(()=>[(0,k.Wm)(p,{value:(0,k.SU)(l).name,"onUpdate:value":u[0]||(u[0]=e=>(0,k.SU)(l).name=e),placeholder:(0,k.SU)(a)("market.task.createGroup.groupNamePlaceholder")},null,8,["value","placeholder"])]),_:1},8,["label"]),(0,k.Wm)(m,{label:"Status"},{default:(0,k.w5)(()=>[(0,k.Wm)(_,{value:(0,k.SU)(l).status,"onUpdate:value":u[1]||(u[1]=e=>(0,k.SU)(l).status=e),options:n},null,8,["value"])]),_:1}),(0,k.Wm)(m,{label:(0,k.SU)(a)("market.task.createGroup.email"),path:"file_data"},{default:(0,k.w5)(()=>[(0,k._)("div",$,[(0,k.Wm)(b,{"is-upload":!1,accept:["csv"],onChange:r}),(0,k._)("div",z,[(0,k.Uk)((0,k.zw)(e.$t("contacts.subscribers.import.fileTypeHint"))+" ",1),(0,k.Wm)(h,{text:"",type:"primary",onClick:o},{default:(0,k.w5)(()=>[(0,k.Uk)((0,k.zw)(e.$t("common.actions.download")),1)]),_:1})])])]),_:1},8,["label"]),(0,k.Wm)(m,{label:e.$t("contacts.subscribers.import.exampleCsvLabel")},{default:(0,k.w5)(()=>[(0,k._)("pre",{class:"csv-example"},(0,k.zw)(T))]),_:1},8,["label"])]),_:1},8,["model"])])]),_:1},8,["title"])}}});var R=t(41748);let H=(0,R.default)(P,[["__scopeId","data-v-5210e9fa"]]),E={class:"flex-1"},q={class:"ml-12px"},N=(0,k.aZ)({__name:"GroupSelect",props:(0,k.Vf)({disabled:{type:Boolean,default:!1}},{value:{default:()=>0},valueModifiers:{},label:{default:()=>""},labelModifiers:{}}),emits:["update:value","update:label"],setup(e){let a=(0,k.tT)(e,"value"),t=(0,k.tT)(e,"label"),l=(0,k.iH)(!1),i=(0,k.iH)([]),[s,n]=(0,W.d)({component:H,state:{refresh:()=>{u()}}}),r=()=>{n.open()},o=async(e,a)=>{t.value=`${a.label}`},u=async()=>{try{l.value=!0;let e=await (0,S.WH)();(0,U.Kn)(e)&&(i.value=e.list.map(e=>({label:e.name,value:e.id})))}finally{l.value=!1}};return u(),(t,n)=>{let u=v.Z,d=c.ZP;return(0,k.wg)(),(0,k.iD)(k.HY,null,[(0,k._)("div",E,[(0,k.Wm)(u,{value:a.value,"onUpdate:value":[n[0]||(n[0]=e=>a.value=e),o],options:(0,k.SU)(i),filterable:!0,disabled:e.disabled,"max-tag-count":"responsive",loading:(0,k.SU)(l),placeholder:t.$t("market.task.edit.recipientsPlaceholder")},null,8,["value","options","disabled","loading","placeholder"])]),(0,k._)("div",q,[(0,k.Wm)(d,{text:"",type:"primary",onClick:r},{default:(0,k.w5)(()=>[(0,k.Uk)((0,k.zw)(t.$t("common.actions.create")),1)]),_:1})]),(0,k.Wm)((0,k.SU)(s))],64)}}});var B=t(43458),D=t(65965);let G={class:"ml-12px"},I=(0,k.aZ)({__name:"TagSelect",props:(0,k.Vf)({groupId:{type:Number,default:null},disabled:{type:Boolean,default:!1}},{value:{default:()=>[]},valueModifiers:{}}),emits:["update:value"],setup(e){let a=(0,k.tT)(e,"value"),t=(0,D.tv)(),l=(0,k.iH)([]),i=(0,k.Fl)(()=>l.value.filter(a=>a.group_id===e.groupId).map(e=>({value:e.id,label:e.name}))),s=async()=>{let e=await (0,B.CZ)({});(0,U.Kn)(e)&&(l.value=e.list)},n=()=>{t.push("/contacts/tags")};return(0,k.YP)(()=>e.groupId,()=>{a.value=[]}),s(),(t,l)=>{let s=v.Z,r=c.ZP;return(0,k.wg)(),(0,k.iD)(k.HY,null,[(0,k.Wm)(s,{value:a.value,"onUpdate:value":l[0]||(l[0]=e=>a.value=e),options:(0,k.SU)(i),disabled:e.disabled,multiple:!0,filterable:!0,"max-tag-count":"responsive"},null,8,["value","options","disabled"]),(0,k._)("div",G,[(0,k.Wm)(r,{text:"",type:"primary",onClick:n},{default:(0,k.w5)(()=>[(0,k.Uk)((0,k.zw)(t.$t("common.actions.create")),1)]),_:1})])],64)}}});var F=t(28444);let L={class:"task-edit-container"},A={class:"flex flex-col flex-1 p-24px overflow-auto"},K={class:"flex-1"},V={class:"flex items-center"},Y={class:"flex-1"},X={class:"ml-12px text-desc"},J={class:"w-60px"},Q={class:"flex-1 mr-10px"},ee={class:"task-preview"},ea={class:"preview-header"},et={class:"preview-header-item"},el={class:"preview-label"},ei={class:"preview-value"},es={class:"preview-header-item"},en={class:"preview-label"},er={class:"preview-value"},eo={class:"preview-header-item"},eu={class:"preview-label"},ed={class:"preview-value"},ec={class:"preview-content"},ep={key:1,class:"empty-preview"},em={class:"action-buttons"},ev=(0,k.aZ)({__name:"edit",setup(e){let{t:a}=(0,M.QT)(),t=(0,D.yj)(),W=(0,D.tv)(),Z=(0,h.s6)(),O=(0,k.AE)("formRef"),j=(0,k.AE)("formContentRef"),{height:C}=(0,w.rBN)(j),$=(0,k.iH)(!1),z=(0,k.iH)(0),T=(0,k.qj)({addresser:null,full_name:"",subject:"",group_id:null,template_id:null,is_record:1,unsubscribe:1,warmup:0,threads:0,start_time:null,remark:"",tag_ids:[],tag_logic:"OR",track_click:1,track_open:1}),P=[{label:"OR",value:"OR"},{label:"AND",value:"AND"},{label:"NOT",value:"NOT"}],R={full_name:{trigger:["blur","input"],validator:()=>""!==T.full_name||Error(a("market.task.edit.validation.displayNameRequired"))},subject:{trigger:["blur","input"],validator:()=>""!==T.subject||Error(a("market.task.edit.validation.subjectRequired"))},group_ids:{trigger:"change",validator:()=>!!T.group_id||Error(a("market.task.edit.validation.recipientsRequired"))},template_id:{trigger:"change",validator:()=>null!==T.template_id||Error(a("market.task.edit.validation.templateRequired"))},start_time:{validator:()=>1!==B.value||null!==T.start_time||Error(a("market.task.edit.validation.sendTimeRequired"))}},H=(0,k.iH)(""),E=(0,k.iH)(0),q=(0,k.iH)(0),B=(0,k.iH)(0),G=(0,k.iH)(""),ev=(0,k.iH)(""),eg=()=>{W.push("/template")},ef=e=>{0===e?T.threads=0:T.threads=5},e_=()=>{0===B.value&&(T.start_time=null)},eb=async()=>G.value?T.subject?T.template_id?void await (0,y.jC)({addresser:T.addresser||"",subject:T.subject,recipient:G.value,template_id:T.template_id||0}):void U.v0.error(a("market.task.edit.validation.templateRequired")):void U.v0.error(a("market.task.edit.validation.subjectRequired")):void U.v0.error(a("market.task.edit.validation.testEmailRequired")),ek=()=>{T.subject||T.group_id?(0,U.iG)({title:a("market.task.edit.discard.title"),content:a("market.task.edit.discard.content"),onConfirm:()=>{W.go(-1)}}):W.go(-1)},eh=async()=>{if(!T.group_id){E.value=0;return}let e=await (0,S.Z2)({group_id:T.group_id||0,tag_ids:T.tag_ids,tag_logic:T.tag_logic});(0,U.Kn)(e)&&(E.value=e.total)},ew=()=>{let e=T.start_time;return(0===B.value||null===e)&&(e=Date.now()),{track_open:T.track_open,track_click:T.track_click,addresser:T.addresser||"",full_name:T.full_name,subject:T.subject,group_id:T.group_id||0,template_id:T.template_id||0,is_record:T.is_record,unsubscribe:T.unsubscribe,warmup:T.warmup,threads:T.threads,start_time:e/1e3,remark:T.remark,tag_ids:T.tag_ids,tag_logic:T.tag_logic}},eU=async()=>{var e;await (null==(e=O.value)?void 0:e.validate()),$.value?await (0,y.xJ)({task_id:z.value,...ew()}):await (0,y.gI)(ew()),W.push("/market/task")};function eS(e){if(t.query.chat_id){let a=e.find(e=>e.chat_id==t.query.chat_id);a&&(T.template_id=a.id,T.subject=Z.temp_subject,ev.value=a.html_content)}}return(async()=>{let{task_id:e,type:a}=t.query;if("edit"===a?(z.value=Number(e),$.value=!0):(z.value=0,$.value=!1),!e)return;let l=await (0,y.mQ)({id:Number(e)});(0,U.Kn)(l)&&(T.addresser=l.addresser,T.full_name=l.full_name,T.subject=l.subject,T.group_id=l.group_id,T.template_id=l.template_id,T.is_record=l.is_record,T.unsubscribe=l.unsubscribe,T.threads=l.threads,q.value=+(0!==l.threads),T.remark=l.remark,T.tag_logic=l.tag_logic,T.track_open=l.track_open,T.track_click=l.track_click,(0,k.Y3)(()=>{T.tag_ids=l.tag_ids}))})(),(e,t)=>{let h=(0,k.up)("router-link"),w=b.Z,U=_.ZP,S=f.ZP,y=g.Z,W=(0,k.up)("i18n-t"),Z=v.Z,M=m.ZP,z=p.Z,D=c.ZP,ew=d.Z,ey=u.Z,ex=o.Z,eW=r.Z,eZ=n.ZP,eO=s.Z,ej=i.Z,eM=l.Z;return(0,k.wg)(),(0,k.iD)("div",L,[(0,k._)("div",A,[(0,k.Wm)(U,{class:"mb-20px"},{default:(0,k.w5)(()=>[(0,k.Wm)(w,null,{default:(0,k.w5)(()=>[(0,k.Wm)(h,{to:"/market/task"},{default:(0,k.w5)(()=>[(0,k.Uk)((0,k.zw)(e.$t("market.task.title")),1)]),_:1})]),_:1}),(0,k.Wm)(w,null,{default:(0,k.w5)(()=>[(0,k.Uk)((0,k.zw)((0,k.SU)($)?e.$t("market.task.edit.editTitle"):e.$t("market.task.edit.addTitle")),1)]),_:1})]),_:1}),(0,k._)("div",{class:"task-edit-box",style:(0,k.j5)({minHeight:(0,k.SU)(C)+"px"})},[(0,k.Wm)(ej,{ref_key:"formRef",ref:O,class:"task-edit-form",model:(0,k.SU)(T),rules:R},{default:(0,k.w5)(()=>[(0,k._)("div",{ref_key:"formContentRef",ref:j},[(0,k.Wm)(eZ,{class:"mb-24px"},{default:(0,k.w5)(()=>[(0,k.Wm)(S,{label:e.$t("market.task.edit.from")},{default:(0,k.w5)(()=>[(0,k.Wm)(x.Z,{value:(0,k.SU)(T).addresser,"onUpdate:value":t[0]||(t[0]=e=>(0,k.SU)(T).addresser=e),name:(0,k.SU)(T).full_name,"onUpdate:name":t[1]||(t[1]=e=>(0,k.SU)(T).full_name=e)},null,8,["value","name"])]),_:1},8,["label"]),(0,k.Wm)(S,{label:e.$t("market.task.edit.displayName"),path:"full_name"},{default:(0,k.w5)(()=>[(0,k.Wm)(y,{value:(0,k.SU)(T).full_name,"onUpdate:value":t[2]||(t[2]=e=>(0,k.SU)(T).full_name=e),placeholder:e.$t("market.task.edit.displayNamePlaceholder")},null,8,["value","placeholder"])]),_:1},8,["label"]),(0,k.Wm)(S,{label:e.$t("market.task.edit.subject"),path:"subject"},{default:(0,k.w5)(()=>[(0,k.Wm)(y,{value:(0,k.SU)(T).subject,"onUpdate:value":t[3]||(t[3]=e=>(0,k.SU)(T).subject=e),placeholder:e.$t("market.task.edit.subjectPlaceholder")},null,8,["value","placeholder"])]),_:1},8,["label"]),(0,k.Wm)(S,{label:e.$t("market.task.edit.recipients"),type:"group_ids"},{default:(0,k.w5)(()=>[(0,k._)("div",K,[(0,k._)("div",V,[(0,k.Wm)(N,{value:(0,k.SU)(T).group_id,"onUpdate:value":t[4]||(t[4]=e=>(0,k.SU)(T).group_id=e),label:(0,k.SU)(H),"onUpdate:label":t[5]||(t[5]=e=>(0,k.dq)(H)?H.value=e:null),disabled:(0,k.SU)($)},null,8,["value","label","disabled"])]),(0,k.Wm)(W,{class:"mt-8px",tag:"div",scope:"global",keypath:"market.task.edit.recipientsCount"},{count:(0,k.w5)(()=>[(0,k._)("b",null,(0,k.zw)((0,k.SU)(E)),1)]),_:1})])]),_:1},8,["label"]),(0,k.Wm)(z,{cols:24,"x-gap":24},{default:(0,k.w5)(()=>[(0,k.Wm)(M,{span:6,label:e.$t("market.task.edit.tagLogic"),path:"tag_logic"},{default:(0,k.w5)(()=>[(0,k.Wm)(Z,{value:(0,k.SU)(T).tag_logic,"onUpdate:value":[t[6]||(t[6]=e=>(0,k.SU)(T).tag_logic=e),t[7]||(t[7]=()=>eh())],options:P,disabled:(0,k.SU)($)},null,8,["value","disabled"])]),_:1},8,["label"]),(0,k.Wm)(M,{span:18,label:e.$t("market.task.edit.tags"),path:"tag_ids"},{default:(0,k.w5)(()=>[(0,k.Wm)(I,{value:(0,k.SU)(T).tag_ids,"onUpdate:value":[t[8]||(t[8]=e=>(0,k.SU)(T).tag_ids=e),t[9]||(t[9]=()=>eh())],"group-id":(0,k.SU)(T).group_id,disabled:(0,k.SU)($)},null,8,["value","group-id","disabled"])]),_:1},8,["label"])]),_:1}),(0,k.Wm)(S,{label:e.$t("market.task.edit.template"),path:"template_id"},{default:(0,k.w5)(()=>[(0,k._)("div",Y,[(0,k.Wm)(F.Z,{value:(0,k.SU)(T).template_id,"onUpdate:value":t[10]||(t[10]=e=>(0,k.SU)(T).template_id=e),content:(0,k.SU)(ev),"onUpdate:content":t[11]||(t[11]=e=>(0,k.dq)(ev)?ev.value=e:null),onListReady:eS},null,8,["value","content"])]),(0,k.Wm)(D,{text:"",type:"primary",class:"ml-12px",onClick:eg},{default:(0,k.w5)(()=>[(0,k.Uk)((0,k.zw)((0,k.SU)(a)("common.actions.create")),1)]),_:1})]),_:1},8,["label"]),(0,k.kq)("",!0),(0,k.Wm)(z,{cols:24,"x-gap":16},{default:(0,k.w5)(()=>[(0,k.Wm)(M,{span:12,label:(0,k.SU)(a)("market.task.edit.ipWarmup")},{default:(0,k.w5)(()=>[(0,k.Wm)(ew,{value:(0,k.SU)(T).warmup,"onUpdate:value":t[13]||(t[13]=e=>(0,k.SU)(T).warmup=e),"checked-value":1,"unchecked-value":0},null,8,["value"]),(0,k._)("span",X,(0,k.zw)((0,k.SU)(a)("market.task.edit.ipWarmupTip")),1)]),_:1},8,["label"]),(0,k.Wm)(M,{span:12,label:e.$t("market.task.edit.unsubscribeLink")},{default:(0,k.w5)(()=>[(0,k.Wm)(ew,{value:(0,k.SU)(T).unsubscribe,"onUpdate:value":t[14]||(t[14]=e=>(0,k.SU)(T).unsubscribe=e),"checked-value":1,"unchecked-value":0},null,8,["value"])]),_:1},8,["label"]),(0,k.Wm)(M,{span:12,label:(0,k.SU)(a)("market.task.edit.trackClick"),path:"track_click"},{default:(0,k.w5)(()=>[(0,k.Wm)(ew,{value:(0,k.SU)(T).track_click,"onUpdate:value":t[15]||(t[15]=e=>(0,k.SU)(T).track_click=e),"checked-value":1,"unchecked-value":0},null,8,["value"])]),_:1},8,["label"]),(0,k.Wm)(M,{span:12,label:(0,k.SU)(a)("market.task.edit.trackOpen"),path:"track_open"},{default:(0,k.w5)(()=>[(0,k.Wm)(ew,{value:(0,k.SU)(T).track_open,"onUpdate:value":t[16]||(t[16]=e=>(0,k.SU)(T).track_open=e),"checked-value":1,"unchecked-value":0},null,8,["value"])]),_:1},8,["label"])]),_:1}),(0,k.Wm)(S,{label:e.$t("market.task.edit.threads"),"show-feedback":!1},{default:(0,k.w5)(()=>[(0,k.Wm)(ex,{value:(0,k.SU)(q),"onUpdate:value":[t[17]||(t[17]=e=>(0,k.dq)(q)?q.value=e:null),ef]},{default:(0,k.w5)(()=>[(0,k.Wm)(ey,{value:0},{default:(0,k.w5)(()=>[(0,k.Uk)((0,k.zw)(e.$t("market.task.edit.threadsAuto")),1)]),_:1}),(0,k.Wm)(ey,{value:1},{default:(0,k.w5)(()=>[(0,k.Uk)((0,k.zw)(e.$t("market.task.edit.threadsCustom")),1)]),_:1})]),_:1},8,["value"]),(0,k.wy)((0,k._)("div",J,[(0,k.Wm)(eW,{value:(0,k.SU)(T).threads,"onUpdate:value":t[18]||(t[18]=e=>(0,k.SU)(T).threads=e),min:1,max:100,"show-button":!1},null,8,["value"])],512),[[k.F8,1===(0,k.SU)(q)]])]),_:1},8,["label"])]),_:1}),(0,k.Wm)(eZ,null,{default:(0,k.w5)(()=>[(0,k.Wm)(S,{label:(0,k.SU)(a)("market.task.edit.sendTime"),path:"start_time"},{default:(0,k.w5)(()=>[(0,k.Wm)(ex,{value:(0,k.SU)(B),"onUpdate:value":[t[20]||(t[20]=e=>(0,k.dq)(B)?B.value=e:null),e_],class:"flex items-center"},{default:(0,k.w5)(()=>[(0,k.Wm)(ey,{value:0},{default:(0,k.w5)(()=>[(0,k.Uk)((0,k.zw)((0,k.SU)(a)("market.task.edit.sendTimeNow")),1)]),_:1}),(0,k.Wm)(ey,{class:"items-center",value:1}),(0,k.Wm)(eO,{value:(0,k.SU)(T).start_time,"onUpdate:value":t[19]||(t[19]=e=>(0,k.SU)(T).start_time=e),class:"ml-8px",type:"datetime",disabled:0===(0,k.SU)(B)},null,8,["value","disabled"])]),_:1},8,["value"])]),_:1},8,["label"]),(0,k.Wm)(S,{label:e.$t("market.task.edit.remark")},{default:(0,k.w5)(()=>[(0,k.Wm)(y,{value:(0,k.SU)(T).remark,"onUpdate:value":t[21]||(t[21]=e=>(0,k.SU)(T).remark=e),placeholder:e.$t("market.task.edit.remarkPlaceholder")},null,8,["value","placeholder"])]),_:1},8,["label"]),(0,k.Wm)(S,{label:e.$t("market.task.edit.testEmail"),"show-feedback":!1},{default:(0,k.w5)(()=>[(0,k._)("div",Q,[(0,k.Wm)(y,{value:(0,k.SU)(G),"onUpdate:value":t[22]||(t[22]=e=>(0,k.dq)(G)?G.value=e:null),placeholder:e.$t("market.task.edit.testEmailPlaceholder")},null,8,["value","placeholder"])]),(0,k.Wm)(D,{onClick:eb},{default:(0,k.w5)(()=>[(0,k.Uk)((0,k.zw)(e.$t("market.task.edit.sendTest")),1)]),_:1})]),_:1},8,["label"])]),_:1})],512)]),_:1},8,["model"]),(0,k._)("div",ee,[(0,k.Wm)(eZ,{class:"h-full","content-style":{display:"flex",flexDirection:"column",height:"100%"}},{default:(0,k.w5)(()=>[(0,k._)("div",ea,[(0,k._)("div",et,[(0,k._)("div",el,(0,k.zw)((0,k.SU)(a)("market.task.edit.from"))+":",1),(0,k._)("div",ei,(0,k.zw)((0,k.SU)(T).addresser),1)]),(0,k._)("div",es,[(0,k._)("div",en,(0,k.zw)((0,k.SU)(a)("market.task.edit.to"))+":",1),(0,k._)("div",er,(0,k.zw)((0,k.SU)(H)||"--"),1)]),(0,k._)("div",eo,[(0,k._)("div",eu,(0,k.zw)((0,k.SU)(a)("market.task.edit.subject"))+":",1),(0,k._)("div",ed,(0,k.zw)((0,k.SU)(T).subject||"--"),1)])]),(0,k._)("div",ec,[(0,k.SU)(ev)?((0,k.wg)(),(0,k.j4)(eM,{key:0,value:(0,k.SU)(ev)},null,8,["value"])):((0,k.wg)(),(0,k.iD)("div",ep,(0,k.zw)((0,k.SU)(a)("market.task.edit.preview.empty")),1))])]),_:1})])],4)]),(0,k._)("div",em,[(0,k.Wm)(D,{type:"primary",onClick:eU},{default:(0,k.w5)(()=>[(0,k.Uk)((0,k.zw)(e.$t("common.actions.confirm")),1)]),_:1}),(0,k.Wm)(D,{class:"ml-16px",secondary:"",onClick:ek},{default:(0,k.w5)(()=>[(0,k.Uk)((0,k.zw)(e.$t("common.actions.back")),1)]),_:1})])])}}}),eg=(0,R.default)(ev,[["__scopeId","data-v-1e63a0e0"]])}}]);